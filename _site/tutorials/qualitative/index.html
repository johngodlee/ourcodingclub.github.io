<!DOCTYPE html>
<html lang="en-GB">
	<head>
    	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Analysing ordinal data, surveys, count data</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- CSS -->
<link rel="stylesheet" href="/css/main.css"/>
<link rel="stylesheet" href="/css/owlcarousel/owl.carousel.css">
<link rel="stylesheet" href="/css/owlcarousel/owl.theme.default.css">

<!-- JS -->
<script src="https://use.fontawesome.com/4dd22df1f8.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="/scripts/accordion.js"></script>
<script src="/scripts/jquery.counterup.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.5/waypoints.min.js"></script>
<script src="/scripts/ticker.js"></script>

	</head>
	<body>
    	<header class="header">
	<div class="navigation-bar">
		<div id="navigation-container">
			
				<a class="logo" href="/">
  <img src="/assets/img/logos/logo_stack.svg" alt="Coding Club logo">
</a>

			
			<nav>
				<label for="hamburger">☰</label>
				<input type="checkbox" id="hamburger">
				<ul>
					
						
					<li class="item item-nav">
						<a href="/">Home</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/tutorials.html">Tutorials</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/course.html">Course</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/team.html">Team</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/involve.html">Get involved</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/links.html">Links</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/contact.html">Contact</a>
					</li>
					
				</ul>
			</nav>
		</div>
	</div>
</header>

			
	<div class="banner">
	
		
			<h1 style="color: $bannerNoImageColour">Analysing ordinal data, surveys, count data</h1>
			
				<h3 style="color: $bannerNoImageColour">Using R to answer sociological questions</h3>
			
		
	
</div>




<div class="content">
	<p class="author">
		
			Created by John
		
		
		
	</p>
	<hr>
	<h3 id="tutorial-aims">Tutorial Aims:</h3>

<ol>
  <li><a href="#format">Learn how to format survey data, coding responses, data types etc.</a></li>
  <li><a href="#visualise">Practise visualising ordinal data, count data, likert scales</a></li>
  <li><a href="#text-mining">Mining text responses and comments for keywords</a></li>
  <li><a href="#analyse">Statistically analyse qualitative data</a></li>
</ol>

<p>This workshop will explore qualitative data, the sort of data you might collect through responses to survey questions, interview transcripts, or observations. The data analysis techniques in this workshop lend themselves well to sociological research, and the examples we will use come from a study on human behaviour related to environmentally friendly actions, but they could easily be applied to observations of any system. For example, you might use an ordinal scale (e.g. 1-5, Disagree-Agree) to describe the perceived health of a plant seedling, with the question being something like “How wilted are the leaves? 1 = no sign of damage, 5 = leaves abcised”.</p>

<p>Firstly, we will learn how to format data from surveys and interviews effectively so that it can be easily used in analysis later. Then we will explore ways to visualise these data graphically. Finally, we will run some simple statistical analyses to answer some hypotheses.</p>

<p>Note: all the files you need to complete this tutorial can be downloaded from <a href="https://github.com/ourcodingclub/CC-Qualit" target="_blank" rel="noopener noreferrer">this repository</a>. Please download the repo as a zip file, then unzip it before starting the tutorial.</p>

<p>Alternatively, you can fork <a href="https://github.com/ourcodingclub/CC-Qualit" target="_blank" rel="noopener noreferrer">the repository</a> to your own GitHub account and then add it as a new <code class="language-plaintext highlighter-rouge">RStudio</code> project by copying the <code class="language-plaintext highlighter-rouge">HTTPS/SSH</code> link. For more details on how to register on GitHub, download <code class="language-plaintext highlighter-rouge">git</code>, sync <code class="language-plaintext highlighter-rouge">RStudio</code> and GitHub and use version control, please check out our <a href="/tutorials/git/index.html"><code class="language-plaintext highlighter-rouge">git</code> and RStudio tutorial</a>.</p>

<h2 id="getting-started">Getting Started</h2>

<p>The first thing to do is open <code class="language-plaintext highlighter-rouge">RStudio</code>. Then make a new script file using <code class="language-plaintext highlighter-rouge">File/ New File/ R Script</code>, save it with a logical name inside the folder you just downloaded and unzipped from <a href="https://github.com/ourcodingclub/CC-time-series" target="_blank" rel="noopener noreferrer">the Github repository</a>.</p>

<p>Next, in your script file you need to set your working directory to the folder you just downloaded from <a href="https://github.com/ourcodingclub/CC-Qualit" target="_blank" rel="noopener noreferrer">the Github repository</a>. Copy and paste the code below as a guide, but remember that the location of the folder on your computer will be different:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">setwd</span><span class="p">(</span><span class="s2">"~/Downloads/CC-Qualit-master"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Next, load the packages needed for this tutorial by copying the code below into your script file then running those lines of code using either <code class="language-plaintext highlighter-rouge">Cmd + R</code> on a Mac, or <code class="language-plaintext highlighter-rouge">Ctrl + R</code> on Windows. If this is the first time you’re using them these packages, you’ll need to install them first, for example using <code class="language-plaintext highlighter-rouge">install.packages("ggplot2")</code>, and afterwards you can use <code class="language-plaintext highlighter-rouge">library()</code> to load them.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidytext</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">R.utils</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Finally, load the data files we will be using for the tutorial.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The survey responses</span><span class="w">
</span><span class="n">sust_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"sust_behaviour.csv"</span><span class="p">)</span><span class="w">

</span><span class="c1"># A lookup table which connects each column in `sust_data` to the actual question on the survey</span><span class="w">
</span><span class="n">sust_lookup</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"sust_lookup.csv"</span><span class="p">)</span><span class="w">

</span><span class="c1"># A list of boring and non-useful words, bundled with `tidytext`</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="n">stop_words</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>These are anonymised data from an online survey designed to investigate whether gender and different cohabitation arrangements influence the likelihood of participants performing environmentally friendly actions around the house, like recycling or buying sustainable household products.</p>

<p>This example dataset is formatted to purposely resemble the sort of thing you might generate from your own survey responses on Google Forms or Survey Monkey. It is not quite ready for analysis yet. We will spend some time getting the data ready for analysis, so that you can learn the skills needed to format your own data for analysis.</p>

<p>The object <code class="language-plaintext highlighter-rouge">sust_lookup</code> is a table which connects the name of each column in the dataframe to the corresponding question that was asked in the survey. Replacing the raw questions with shorter column names makes it much easier to write code, and with the lookup table we can add the actual question title back in when we are creating plots.</p>

<h2 id="format">1. Formatting qualitative data</h2>

<p>Getting qualitative data into a suitable format for analysis is a key pre-requisite for success - you’re setting yourself up for the coding fun to follow! Most analytical tools are best suited to numerical datasets, so some coercion is needed to generate numerical values from our qualitative observations. When you are designing a survey, emember to consider how you will analyse the data, draw out how you imagine your graphs will look, etc., this will make it much easier later on.</p>

<p>Some of the questions in this data set were designed on a five point scale, also known as a Likert scale. Each column in the dataframe contains responses to a single question. You can Look at the values contained in the column titled  <code class="language-plaintext highlighter-rouge">sustainability_daily_think</code> entering this code:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unique</span><span class="p">(</span><span class="n">sust_data</span><span class="o">$</span><span class="n">sustainability_daily_think</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>You should see that the column contains five discrete categories that follow an intuitive order from low to high: <code class="language-plaintext highlighter-rouge">Never</code>, <code class="language-plaintext highlighter-rouge">Rarely</code>, <code class="language-plaintext highlighter-rouge">Sometimes</code>, <code class="language-plaintext highlighter-rouge">Often</code>, <code class="language-plaintext highlighter-rouge">All the time </code>. We could just treat the responses as factors, but this doesn’t take into account their ordinal nature, any plots that we make will simply place the factors in alphabetical order, so instead we will ask R to treat them as an “ordered factor” using this code:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_data</span><span class="o">$</span><span class="n">sustainability_daily_think</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">sust_data</span><span class="o">$</span><span class="n">sustainability_daily_think</span><span class="p">,</span><span class="w">
	</span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Never"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rarely"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Sometimes"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Often"</span><span class="p">,</span><span class="w"> </span><span class="s2">"All the time"</span><span class="p">),</span><span class="w"> 
	</span><span class="n">ordered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Look for other columns that you think contain ordered factor data like these ones, then change them to ordered factors in the same way you did above. You can search for columns using:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">sust_data</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>OR</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">sust_data</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Other columns in the data frame, such as <code class="language-plaintext highlighter-rouge">sust_data$energy_action</code>, contain strings of letters, e.g. <code class="language-plaintext highlighter-rouge">BDEFH</code>. This question on the survey presented the user with a list of sustainable actions related to the home, e.g. “I have replaced my lightbulbs with energy saving lightbulbs” and asked the user to tick all the ones that applied to them. Each of the letters refers to a single action. The format of this column is similar to what you would receive if you downloaded the raw results of a Google Form.</p>

<p>Imagine we want to ask the question “Does the number of sustainable energy-related actions performed vary according to gender?”. To do this we need to create a column in the data frame which counts the number of letters in <code class="language-plaintext highlighter-rouge">sust_data$energy_action</code>. To do this we can use <code class="language-plaintext highlighter-rouge">nchar()</code>, a simple function which counts the number of characters in a string. Additionally, we have to use <code class="language-plaintext highlighter-rouge">as.character()</code> to coerce <code class="language-plaintext highlighter-rouge">energy_action</code> to a character variable, as it is currently encoded as a factor, which isn’t compatible with <code class="language-plaintext highlighter-rouge">nchar()</code>.
:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_data</span><span class="o">$</span><span class="n">energy_action_n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nchar</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">sust_data</span><span class="o">$</span><span class="n">energy_action</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<h2 id="visualise">2. Visualising qualitative data</h2>

<p>Now that we formatted our data for analysis we can visualise the data to identify interesting patterns.</p>

<p>Let’s start with the Likert scales. We can create bar charts to visualise the number of responses to a question which fit into each of the ordinal categories. The correct form for the bar chart will depend on the type of question that was asked, and the wording of the various responses. For example, if potential responses were presented as “Strongly disagree”, “Disagree”, “Neither agree nor disagree”, “Agree”, “Strongly agree”, you could assume that the neutral or zero answer is in the middle, with Disagree being negative and Agree being positive. On the other hand, if the answers were presented as “Never”, “Rarely”, “Sometimes”, “Often”, “All the time”, the neutral or zero answer would be Never, with all other answers being positive. For the first example, we could use a “diverging stacked bar chart”, and for the latter we would just use a standard “stacked bar chart”.</p>

<h3 id="diverging-stacked-bar-chart">Diverging stacked bar chart</h3>

<p>Let’s first make a diverging stacked bar chart of responses to the question: “How often during a normal day do you think about the sustainability of your actions?”. Investigating how gender affects the response. You can see from the lookup table (<code class="language-plaintext highlighter-rouge">sust_lookup</code>) that the responses to this question are stored in the column called <code class="language-plaintext highlighter-rouge">sustainability_daily_think</code>.</p>

<p>Check for yourself by entering the code below to display the contents of the <code class="language-plaintext highlighter-rouge">sust_lookup</code> object:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_lookup</span><span class="w">
</span></code></pre></div></div>

<p>If you look in the <code class="language-plaintext highlighter-rouge">sustainability_daily_think</code> column, you will see that it contains rows like <code class="language-plaintext highlighter-rouge">Often</code>, <code class="language-plaintext highlighter-rouge">Never</code>, and <code class="language-plaintext highlighter-rouge">All the time</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_data</span><span class="o">$</span><span class="n">sustainability_daily_think</span><span class="w">
</span></code></pre></div></div>

<p>First, we need to make a summary data frame of the responses from this column, which can be done easily using the <code class="language-plaintext highlighter-rouge">dplyr</code> package. For an introduction to <code class="language-plaintext highlighter-rouge">dplyr</code>, check out <a href="/tutorials/piping/index.html">our tutorial on data manipulation and formatting</a>. You can use the code below to make a summary table:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_think_summ_wide</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">group_by</span><span class="p">(</span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">sustainability_daily_think</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># grouping by these two variables</span><span class="w">
	</span><span class="n">tally</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># counting the number of responses</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">dplyr</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">group_by</span><span class="p">(</span><span class="n">gender</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">spread</span><span class="p">(</span><span class="n">sustainability_daily_think</span><span class="p">,</span><span class="w"> </span><span class="n">perc</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">group_by()</code> and <code class="language-plaintext highlighter-rouge">tally()</code> work together to count the number of responses to the question, splitting the count into each combination of gender (e.g. Male, Female) and type of response (e.g. Never, Often, etc.). <code class="language-plaintext highlighter-rouge">mutate()</code> creates another column called <code class="language-plaintext highlighter-rouge">perc</code> which is the percentage of the total respondents which responded based on their gender and response. <code class="language-plaintext highlighter-rouge">dplyr::select()</code> drops the <code class="language-plaintext highlighter-rouge">n</code> column which was created using <code class="language-plaintext highlighter-rouge">tally()</code>. The second <code class="language-plaintext highlighter-rouge">group_by()</code> and <code class="language-plaintext highlighter-rouge">spread()</code> work together to convert the data frame from long format, to wide format. It’s easier to demonstrate what this means with a diagram:</p>

<p><strong>Long Format:</strong></p>

<table style="text-align:center; margin:10px">
<tr>
<td colspan="4" style="border-bottom: 1px solid black"></td>
</tr>
<tr>
<td></td>
<td style="padding:0 15px 0 15px">gender</td>
<td style="padding:0 15px 0 15px">sustainability_daily_think</td>
<td style="padding:0 15px 0 15px">perc</td>
</tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
<tr>
<td style="padding:0 15px 0 15px">1</td>
<td>Female</td>
<td>Never</td>
<td>1.575</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">2</td>
<td>Female</td>
<td>Rarely</td>
<td>1.575</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">3</td>
<td>Female</td>
<td>Sometimes</td>
<td>32.283</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">4</td>
<td>Female</td>
<td>Often</td>
<td>51.181</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">5</td>
<td>Female</td>
<td>All the time</td>
<td>13.386</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">6</td>
<td>Male</td>
<td>Never</td>
<td>3.226</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">7</td>
<td>Male</td>
<td>Rarely</td>
<td>6.452</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">8</td>
<td>Male</td>
<td>Sometimes</td>
<td>32.258</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">9</td>
<td>Male</td>
<td>Often</td>
<td>38.710</td>
</tr>
<tr>
<td style="padding:0 15px 0 15px">10</td>
<td>Male</td>
<td>All the time</td>
<td>19.355</td>
</tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
</table>

<p><strong>Wide Format:</strong></p>

<table style="text-align:center; margin:10px">
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr>
<tr>
<td style="text-align:left"></td>
<td style="padding:0 15px 0 15px">gender</td>
<td style="padding:0 15px 0 15px">Never</td>
<td style="padding:0 15px 0 15px">Rarely</td>
<td style="padding:0 15px 0 15px">Sometimes</td>
<td style="padding:0 15px 0 15px">Often</td>
<td style="padding:0 15px 0 15px">All the time</td>
</tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr>
<tr>
<td style="text-align:left">1</td>
<td style="padding:0 15px 0 15px">Female</td>
<td style="padding:0 15px 0 15px">1.575</td>
<td style="padding:0 15px 0 15px">1.575</td>
<td style="padding:0 15px 0 15px">32.283</td>
<td style="padding:0 15px 0 15px">51.181</td>
<td style="padding:0 15px 0 15px">13.386</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td>Male</td>
<td>3.226</td>
<td>6.452</td>
<td>32.258</td>
<td>38.710</td>
<td>19.355</td>
</tr>
<tr><td colspan="7" style="border-bottom: 1px solid black"></td></tr>
</table>

<p>In a long format, each column contains a unique variable (e.g. gender, percentage), whereas in a wide format, the percentage data is spread across five columns, where each column is a response type.</p>

<p>And now for the code to create the plot. First, let’s have a look at what we are aiming for:</p>

<p><img src="/assets/img/tutorials/qualitative/diverging_bar_likert.png" alt=""></p>

<p>This type of plot is called a diverging stacked bar chart. “Stacked” means that each bar is further split into sub-categories, in this case each bar is a gender and each sub-bar is the percentage of that gender giving a particular response. “Diverging” means that the bar is straddled over the zero line. Formatting the bar chart in this way allows us to make a visual distinction between negative responses (i.e. Never, Rarely), positive responses (i.e. Often, All the time) and neutral responses (i.e. Sometimes).</p>

<p>To get the “Sometimes” responses to straddle the 0 line, we have to split the “Sometimes” values into two groups (<code class="language-plaintext highlighter-rouge">midlow</code> and <code class="language-plaintext highlighter-rouge">midhigh</code>), one group will sit below the zero line and one group will sit above. To do this we can use <code class="language-plaintext highlighter-rouge">dplyr</code> again:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_think_summ_hi_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_think_summ_wide</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">midlow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sometimes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
		</span><span class="n">midhigh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sometimes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">dplyr</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">Never</span><span class="p">,</span><span class="w"> </span><span class="n">Rarely</span><span class="p">,</span><span class="w"> </span><span class="n">midlow</span><span class="p">,</span><span class="w"> </span><span class="n">midhigh</span><span class="p">,</span><span class="w"> </span><span class="n">Often</span><span class="p">,</span><span class="w"> </span><span class="n">`All the time`</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">gather</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">perc</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">7</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">`colnames &lt;-`</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"gender"</span><span class="p">,</span><span class="w"> </span><span class="s2">"response"</span><span class="p">,</span><span class="w"> </span><span class="s2">"perc"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>In the code above we have created two new columns <code class="language-plaintext highlighter-rouge">midhigh</code> and <code class="language-plaintext highlighter-rouge">midlow</code>, which both contain values from <code class="language-plaintext highlighter-rouge">Sometimes</code>, but divided by two. The <code class="language-plaintext highlighter-rouge">Sometimes</code> column is then dropped from the data frame using <code class="language-plaintext highlighter-rouge">dplyr::select()</code>. The data frame is then gathered back into long format so there are three columns, gender, response type, and percentage of respondents.</p>

<p>Next, we have to split the data frame into two data frames, one containing the negative responses and half of <code class="language-plaintext highlighter-rouge">Sometimes</code> (i.e. <code class="language-plaintext highlighter-rouge">midlow</code>) and one containing the positive repsonses and the other half of <code class="language-plaintext highlighter-rouge">Sometimes</code> (i.e. <code class="language-plaintext highlighter-rouge">midhigh</code>). We need to do this because there are actually two sets of bars on the graph, one for the left side of the zero line and one for the right of the zero line.</p>

<p><strong>The code below creates two new data frames. <code class="language-plaintext highlighter-rouge">%in%</code> allows us to search for multiple matches in the <code class="language-plaintext highlighter-rouge">response</code> column, whereas <code class="language-plaintext highlighter-rouge">==</code> only allows us to search for one response:</strong></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_think_summ_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_think_summ_hi_lo</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"All the time"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Often"</span><span class="p">,</span><span class="w"> </span><span class="s2">"midhigh"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"All the time"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Often"</span><span class="p">,</span><span class="w"> </span><span class="s2">"midhigh"</span><span class="p">)))</span><span class="w">

</span><span class="n">sust_think_summ_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_think_summ_hi_lo</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"midlow"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rarely"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Never"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Never"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rarely"</span><span class="p">,</span><span class="w"> </span><span class="s2">"midlow"</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<p>Next, in order to change the colours on the plot, we need to define a custom colour scheme. To do this, we can use a colour palette from <code class="language-plaintext highlighter-rouge">RColorBrewer</code> and tweak it a bit.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Use RColorBrewer to store a preset diverging colour palette as a vector of colour codes </span><span class="w">
</span><span class="n">legend_pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"RdBu"</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">

</span><span class="c1"># Duplicate the middle value, remember that "Sometimes" is actually two groups, "midhigh" and "midlow"</span><span class="w">
</span><span class="n">legend_pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">insert</span><span class="p">(</span><span class="n">legend_pal</span><span class="p">,</span><span class="w"> </span><span class="n">ats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">legend_pal</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w">

</span><span class="c1"># Replace the ugly white colour for "Sometimes" with a pleasant dishwater grey</span><span class="w">
</span><span class="n">legend_pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"#F7F7F7"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#9C9C9C"</span><span class="p">,</span><span class="w"> </span><span class="n">legend_pal</span><span class="p">)</span><span class="w">

</span><span class="c1"># Assign names to the vector based on the colours we want for each group</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">legend_pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"All the time"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Often"</span><span class="p">,</span><span class="w"> </span><span class="s2">"midhigh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"midlow"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rarely"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Never"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Now we are ready to make our graph, the exciting part!</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sust_think_summ_hi</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">perc</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">),</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sust_think_summ_lo</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=-</span><span class="n">perc</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">),</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"black"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">legend_pal</span><span class="p">,</span><span class="w"> 
		</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"All the time"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Often"</span><span class="p">,</span><span class="w"> </span><span class="s2">"midhigh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rarely"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Never"</span><span class="p">),</span><span class="w">
		</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"All the time"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Often"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Sometimes"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rarely"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Never"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Gender"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Percentage of respondents (%)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">ggtitle</span><span class="p">(</span><span class="n">sust_lookup</span><span class="o">$</span><span class="n">survey_question</span><span class="p">[</span><span class="n">sust_lookup</span><span class="o">$</span><span class="n">column_title</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"sustainability_daily_think"</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_classic</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p>There are two <code class="language-plaintext highlighter-rouge">geom_bar()</code> arguments - one for the positive responses and one for the negative responses. <code class="language-plaintext highlighter-rouge">geom_hline()</code> makes the 0 line. <code class="language-plaintext highlighter-rouge">scale_fill_manual()</code> applies the colour scheme. Notice that <code class="language-plaintext highlighter-rouge">breaks =</code> is a vector of colour values that will be included in the legend, and <code class="language-plaintext highlighter-rouge">labels =</code> gives them custom names, in this case, turning “midhigh” to “Sometimes” and excluding <code class="language-plaintext highlighter-rouge">midlow</code> entirely. <code class="language-plaintext highlighter-rouge">coord_flip()</code> rotates the whole plot 90 degrees, meaning the bars are now horizontal. <code class="language-plaintext highlighter-rouge">labs()</code> and <code class="language-plaintext highlighter-rouge">ggtitle()</code> define the custom x and y axis labels and the title. <code class="language-plaintext highlighter-rouge">ggtitle()</code> accesses the lookup table to display the name of the question from the name of the column in our original data frame. <code class="language-plaintext highlighter-rouge">theme_classic()</code> just makes the whole plot look nicer, removing the default grey background.</p>

<p>Of course, there are other options to display this sort of data. You could use a pie chart, or just a basic table showing the number of responses by group, but the diverging bar chart effectively compares groups of respondees, or even answers to different questions, if you group by question instead of gender.</p>

<h3 id="basic-stacked-bar-chart">Basic stacked bar chart</h3>

<p>To make a conventional stacked bar chart, we will use the question on “How many of these energy related sustainable actions do you perform?”, the responses to which are found in <code class="language-plaintext highlighter-rouge">sust_data$energy_action</code>.</p>

<p>First, we need to count the number of sustainable actions performed, like we did earlier:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_data</span><span class="o">$</span><span class="n">energy_action_n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nchar</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">sust_data</span><span class="o">$</span><span class="n">energy_action</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>Then we can define a custom colour palette for red and blue and name the colours after our gender categories:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">male_female_pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#0389F0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#E30031"</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">male_female_pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Male"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Female"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Then create the plot:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">barchart</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">sust_data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="n">energy_action_n</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gender</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">geom_bar</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">male_female_pal</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">theme_classic</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p>Note that putting your entire ggplot code in brackets () creates the graph and then shows it in the plot viewer. If you don’t have the brackets, you’ve only created the object, but haven’t visualized it. You would then have to call the object such that it will be displayed by just typing <code class="language-plaintext highlighter-rouge">barplot</code> after you’ve created the “barplot” object.</p>

<p><img src="/assets/img/tutorials/qualitative/stacked_bar_qual.png" alt=""></p>

<h3 id="bubble-plot">Bubble plot</h3>

<p>If we want to compare correlations between two categories of data, we can use a bubble plot. For example, is there a pattern between age of respondent and how often they think about sustainable activities? The data from this survey doesn’t contain actual age values, only age ranges (e.g. 18-20, 21-29 etc.).</p>

<p>First, create a summary table by tallying the number of responses by the two groups, age and how often they think about sustainable activities:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_bubble</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">group_by</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">sustainability_daily_think</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">tally</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p>Then to create the bubble plot, simply adjust the size of points according to their frequency of occurrence (<code class="language-plaintext highlighter-rouge">n</code>):</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">bubbleplot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">sust_bubble</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sustainability_daily_think</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">theme_classic</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/img/tutorials/qualitative/bubble_chart_qual.png" alt=""></p>

<h2 id="text-mining">3. Mining text responses and comments for keywords</h2>

<p>As well as the tick box style questions, some questions in our survey asked for free-hand text comments. These comments give some extra information and context to survey responses and shouldn’t be ignored. As an example, look at the column <code class="language-plaintext highlighter-rouge">energy_action_comment</code> by typing:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_data</span><span class="o">$</span><span class="n">energy_action_comment</span><span class="w">
</span></code></pre></div></div>

<p>We can mine the comments for keywords to build up a more complete picture of what our respondents were thinking about when they did the survey and whether that varies by gender. To make the comments easier to work with, we should make the data “tidy” by splitting each comment so that each row has a single word only.</p>

<h3 id="comments-from-all-the-questions">Comments from all the questions</h3>

<p>The following pipe collects all the comment columns along with the gender and id columns (<code class="language-plaintext highlighter-rouge">dplyr::select()</code>), then gathers those comment columns together into a single column (<code class="language-plaintext highlighter-rouge">gather()</code>), then transforms the comments column from a factor into a character class (<code class="language-plaintext highlighter-rouge">mutate()</code>). Note that we are using <code class="language-plaintext highlighter-rouge">dplyr::select()</code> instead of just <code class="language-plaintext highlighter-rouge">select()</code> - this is because often we have other packages loaded that might also have a <code class="language-plaintext highlighter-rouge">select()</code> function within them, so we want to explicitly state that we want to use the <code class="language-plaintext highlighter-rouge">select()</code> function from the <code class="language-plaintext highlighter-rouge">dplyr</code> package.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_comm_gather</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
	</span><span class="n">dplyr</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">energy_action_comment</span><span class="p">,</span><span class="w"> 
		</span><span class="n">food_action_comment</span><span class="p">,</span><span class="w"> </span><span class="n">water_action_comment</span><span class="p">,</span><span class="w"> 
		</span><span class="n">waste_action_comment</span><span class="p">,</span><span class="w"> </span><span class="n">other_action_comment</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">gather</span><span class="p">(</span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="n">comment</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">gender</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">comment</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>The next pipe takes that gathered data and uses <code class="language-plaintext highlighter-rouge">unnest_tokens()</code> from the <code class="language-plaintext highlighter-rouge">tidytext</code> package to split the comments so that there is only one word per row, then it uses the list of boring words from the <code class="language-plaintext highlighter-rouge">stop_words</code> object that we loaded earlier to remove those words from our dataset (<code class="language-plaintext highlighter-rouge">anti_join()</code>). Then it counts the number of occurrences of each unique word in the <code class="language-plaintext highlighter-rouge">comment_word</code> column. Finally a bit of tidying in the form of removing words which occur less than 5 times (<code class="language-plaintext highlighter-rouge">filter(n &gt; 5)</code>) and removing NA values (<code class="language-plaintext highlighter-rouge">filter(!is.na(comment_word))</code>):</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sust_comm_tidy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_comm_gather</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">group_by</span><span class="p">(</span><span class="n">gender</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">unnest_tokens</span><span class="p">(</span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comment_word</span><span class="p">,</span><span class="w">
		</span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comment</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">anti_join</span><span class="p">(</span><span class="n">stop_words</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"comment_word"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"word"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">count</span><span class="p">(</span><span class="n">comment_word</span><span class="p">,</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">  </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">comment_word</span><span class="p">))</span><span class="w"> 
</span></code></pre></div></div>

<p>Now it is easy to plot the occurrences of each word, and colour by gender (<code class="language-plaintext highlighter-rouge">fill = gender</code>), using <code class="language-plaintext highlighter-rouge">ggplot()</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">occurrence</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">sust_comm_tidy</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comment_word</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gender</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">male_female_pal</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">theme_classic</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/img/tutorials/qualitative/comment_gender_qual.png" alt=""></p>

<h3 id="comments-from-a-single-question">Comments from a single question</h3>

<p>We might also want to investigate a single question’s comments in more detail. For example, the <code class="language-plaintext highlighter-rouge">energy_action_comment</code> column. First repeat the action of converting to character format (<code class="language-plaintext highlighter-rouge">mutate()</code>), then split the column so each row is one word (<code class="language-plaintext highlighter-rouge">unnest_tokens()</code>), then remove boring words (<code class="language-plaintext highlighter-rouge">antijoin()</code>), and count the frequency of each word:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tidy_energy_often_comment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sust_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">energy_action_comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">energy_action_comment</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">unnest_tokens</span><span class="p">(</span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energy_action_comment_word</span><span class="p">,</span><span class="w">
		</span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energy_action_comment</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">anti_join</span><span class="p">(</span><span class="n">stop_words</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"energy_action_comment_word"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"word"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">count</span><span class="p">(</span><span class="n">energy_action_comment_word</span><span class="p">,</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<p>Then keep only the most common words and plot it as a bar chart:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tidy_energy_often_comment_summ</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tidy_energy_often_comment</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">energy_action_comment_word</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">mutate</span><span class="p">(</span><span class="n">energy_action_comment_word</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reorder</span><span class="p">(</span><span class="n">energy_action_comment_word</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">))</span><span class="w">

</span><span class="p">(</span><span class="n">most_common_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">tidy_energy_often_comment_summ</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energy_action_comment_word</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">geom_col</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
	</span><span class="n">xlab</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># this means we don't want an axis title</span><span class="w">
	</span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
	</span><span class="n">theme_classic</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/img/tutorials/qualitative/word_bar_qual.png" alt=""></p>

<h3 id="wordclouds">Wordclouds</h3>

<p>To effectively plot more words and their frequencies, you could also create a word cloud:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tidy_energy_often_comment</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
	</span><span class="n">with</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">(</span><span class="n">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">energy_action_comment_word</span><span class="p">,</span><span class="w"> </span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">max.words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/img/tutorials/qualitative/wordcloud_qual.png" alt=""></p>

<p>For more on text mining using <code class="language-plaintext highlighter-rouge">tidytext</code>, you can check out <a href="https://www.tidytextmining.com" target="_blank" rel="noopener noreferrer">the Gitbook website</a>.</p>

<h2 id="analyse">4. Analyse qualitative data</h2>

<p>Due to the way survey data are usually formatted, with lot of counts and factors, the assumptions of conventional parametric statistical analysis are often violated, so we can branch out from our usual linear models! Below are a few examples of how to test various hypotheses using our survey data.</p>

<h3 id="chi-squared">Chi-squared</h3>

<p>To test if there is a statistically significant correlation between gender and how often sustainable tasks are though about, we can use a chi-squared test of independence.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gender_think_chi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">chisq.test</span><span class="p">(</span><span class="n">sust_data</span><span class="o">$</span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">sust_data</span><span class="o">$</span><span class="n">sustainability_daily_think</span><span class="p">)</span><span class="w">
</span><span class="n">gender_think_chi</span><span class="w">
</span></code></pre></div></div>

<p>The output of the <code class="language-plaintext highlighter-rouge">gender_think_chi</code> object can be used to interpret the outcome of the chi-squared test, with a lower p-value indicating a greater probability that the two variables are dependent on each other. In this case, <code class="language-plaintext highlighter-rouge">p = 0.01518</code>, which is lower than the conventional threshold of <code class="language-plaintext highlighter-rouge">0.05</code>, meaning we can reject the null hypothesis that gender does not correlate with the frequency at which people think about sustainable tasks.</p>

<h3 id="poisson-regression">Poisson regression</h3>

<p>For a more in depth analysis, we might hypothesise that gender causes the difference in the number of energy related sustainable actions performed. This is in contrast to the Chi-squared test which merely suggests a non-directional correlative tendency between the two variables. As the number of actions performed is count data, we can use a <code class="language-plaintext highlighter-rouge">Poisson regression</code>, which is a type of a generalised linear model:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">energy_action_pois</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">energy_action_n</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"poisson"</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sust_data</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">energy_action_pois</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>In this case it seems like there actually isn’t much effect of gender on number of actions performed, with a very low z-value of <code class="language-plaintext highlighter-rouge">0.343</code> and a non-significant p-value (<code class="language-plaintext highlighter-rouge">0.732</code>). This means we cann accept the null hypothesis that gender does not affect the number of sustainable energy actions performed.</p>

<h3 id="multi-variate-poisson-regression">Multi-variate Poisson regression</h3>

<p>Going deeper, we might hypothesise that gender and age interact to determine the amount of sustainable food related actions. For example, maybe the difference between genders becomes more accentuated as age increases. Including age in our model might help to make the model fit better and explain more variance. This effect can be included in a generalised linear model as an “interaction term”. In the code below <code class="language-plaintext highlighter-rouge">gender * age</code> defines the interaction between those two explanatory variables:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">energy_action_pois_int</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">energy_action_n</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">gender</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"poisson"</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sust_data</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">energy_action_pois_int</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>We don’t find support for our hypothesis that gender differences increase with age, as the effect size for the interaction term is very small.</p>

<h3 id="conclusion">Conclusion</h3>

<p><strong>In this tutorial, we learned how to visualise qualitative data using different types of plots, as well as how to analyse the data to test different hypotheses, hopefully getting you one step closer to unwrapping your data presents!</strong></p>


	<div class="survey">
	<hr>
	<hr>
	
		<h4><a href="" target="_blank">We would love to hear your feedback, please fill out our survey!</a></h4>
	
	<h4>Contact us with any questions on <a href="mailto:ourcodingclub@gmail.com?Subject=Tutorial%20question" target="_top">ourcodingclub@gmail.com</a>
</h4>
	<br>
	<h3>Related tutorials:</h3>
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
		
	
		
  			
		
	
		
  			
		
	
		
  			
    				
			
		
	
		
  			
    				
			
		
	
		
  			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
		
	
		
  			
		
	
		
  			
		
	
		
  			
		
	
		
  			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
		
	
		
  			
		
	
		
  			
		
	
		
  			
		
	
		
  			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
		
	
		
  			
    				
			
		
	
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
    				
			
    				
			
    				
			
		
	
		
  			
		
	
		
  			
    				
			
		
	
	<br>
	<h3>Subscribe to our mailing list:</h3>

	<div class="container">
		<div class="block">
			<!-- subscribe form start -->
			<div class="form-group">
				<form action="https://getsimpleform.com/messages?form_api_token=de1ba2f2f947822946fb6e835437ec78" method="post">
					<div class="form-group">
						<input type="text" class="form-control" name="Email" placeholder="Email" required>
					</div>
					<div>
            			<button class="btn btn-default" type="submit">Subscribe</button>
        			</div>
            	</form>
			</div>
		</div>
	</div>
</div>

</div>

    	<footer class="footer">
	<hr>
	<div class="footer-container">
    	<ul class="footer-link-list">
        	<li><a href="/tutorials">Tutorials</a></li>
        	<li><a href="/team">About Us</a></li>
        	<li><a href="/contact">Contact us</a></li>
	    	<li><a href="https://twitter.com/our_codingclub" target="_blank" rel="noopener noreferrer">Follow us on Twitter</a></li>
    	</ul>
    	<div class="footer-text">
			<p>We are happy for people to use and further develop our tutorials - please give credit to Coding Club by linking to <a href="https://ourcodingclub.github.io/" target="_blank" rel="noopener noreferrer">our website</a>. We are also happy to discuss possible collaborations, so get in touch at <b>ourcodingclub@gmail.com</b></p>
    		<p>See our <a href="/terms">Terms of Use</a> and our <a href="/privacy">Data Privacy policy</a>.</p>
			<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer">Creative Commons Attribution-ShareAlike 4.0 International License</a></p>
			<a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer"><img class="license" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" alt="CC-by-sa-4.0"></a>
    	</div>
    </div>
</footer>

<!-- JS -->
<script src="/scripts/owl.carousel.js"></script>
<script src="/scripts/owl.carousel-init.js"></script>
<script src="/scripts/reveal.js"></script>


	
	</body>
</html>
