<!DOCTYPE html>
<html lang="en-GB">
	<head>
    	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Introduction to ordination</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- CSS -->
<link rel="stylesheet" href="/css/main.css"/>
<link rel="stylesheet" href="/css/owlcarousel/owl.carousel.css">
<link rel="stylesheet" href="/css/owlcarousel/owl.theme.default.css">

<!-- JS -->
<script src="https://use.fontawesome.com/4dd22df1f8.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="/scripts/accordion.js"></script>
<script src="/scripts/jquery.counterup.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.5/waypoints.min.js"></script>
<script src="/scripts/ticker.js"></script>

	</head>
	<body>
    	<header class="header">
	<div class="navigation-bar">
		<div id="navigation-container">
			
				<a class="logo" href="/">
  <img src="/assets/img/logos/logo_stack.svg" alt="Coding Club logo">
</a>

			
			<nav>
				<label for="hamburger">☰</label>
				<input type="checkbox" id="hamburger">
				<ul>
					
						
					<li class="item item-nav">
						<a href="/">Home</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/tutorials.html">Tutorials</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/course.html">Course</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/team.html">Team</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/involve.html">Get involved</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/links.html">Links</a>
					</li>
					
						
					<li class="item item-nav">
						<a href="/contact.html">Contact</a>
					</li>
					
				</ul>
			</nav>
		</div>
	</div>
</header>

			<div class="block">
	<center>
		<img src="/img/tutheaderordination.png" alt="Img">
	</center>
</div>

<h3 id="tutorial-aims">Tutorial Aims</h3>

<h4 id="-1-get-familiar-with-ordination"><a href="#section1"> 1. Get familiar with ordination</a></h4>

<h4 id="-2-learn-about-the-different-ordination-techniques"><a href="#section2"> 2. Learn about the different ordination techniques</a></h4>

<h4 id="-3-interpret-ordination-results"><a href="#section3"> 3. Interpret ordination results</a></h4>

<p><strong>In this tutorial, we will learn to use ordination to explore patterns in multivariate ecological datasets. We will mainly use the <code class="language-plaintext highlighter-rouge">vegan</code> package to introduce you to three (unconstrained) ordination techniques: Principal Component Analysis (PCA), Principal Coordinate Analysis (PCoA) and Non-metric Multidimensional Scaling (NMDS).</strong></p>

<p><strong>Make a new script file using <code class="language-plaintext highlighter-rouge">File/ New File/ R Script</code> and we are all set to explore the world of ordination. We will use data that are integrated within the packages we are using, so there is no need to download additional files.</strong></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set the working directory (if you didn`t do this already)</span><span class="w">
</span><span class="n">setwd</span><span class="p">(</span><span class="s2">"your_filepath"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Install and load the following packages</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"vegan"</span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"ape"</span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"dplyr"</span><span class="p">)</span><span class="w">

</span><span class="n">library</span><span class="p">(</span><span class="n">vegan</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ape</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<hr>

<p><a name="section1"></a></p>
<h1 id="1-what-is-ordination">1. What is ordination?</h1>

<h2 id="goals-of-ordination">Goals of ordination</h2>
<p><strong>Ordination is a collective term for multivariate techniques which summarize a multidimensional dataset in such a way that when it is projected onto a low dimensional space, any intrinsic pattern the data may possess becomes apparent upon visual inspection (Pielou, 1984).</strong></p>

<p>In ecological terms: Ordination summarizes community data (such as species abundance data: samples by species) by producing a low-dimensional ordination space in which similar species and samples are plotted close together, and dissimilar species and samples are placed far apart.  Ideally and typically, dimensions of this low dimensional space will represent important and interpretable environmental gradients.</p>

<p><strong>Generally, ordination techniques are used in ecology to describe relationships between species composition patterns and the underlying environmental gradients (e.g. what environmental variables structure the community?). Two very important advantages of ordination is that 1) we can determine the relative importance of different gradients and 2) the graphical results from most techniques often lead to ready and intuitive interpretations of species-environment relationships.</strong></p>

<p>To give you an idea about what to expect from this ordination course today, we’ll run the following code.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load the community dataset which we`ll use in the examples today</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="n">varespec</span><span class="p">)</span><span class="w">

</span><span class="c1"># Open the dataset and look if you can find any patterns</span><span class="w">
</span><span class="n">View</span><span class="p">(</span><span class="n">varespec</span><span class="p">)</span><span class="w">
</span><span class="c1"># It is probably very difficult to see any patterns by just looking at the data frame!</span><span class="w">

</span><span class="c1"># With this command, you`ll perform a NMDS and plot the results</span><span class="w">
</span><span class="n">varespec</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">metaMDS</span><span class="p">(</span><span class="n">trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ordiplot</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">text</span><span class="p">(</span><span class="s2">"sites"</span><span class="p">)</span><span class="w">

</span></code></pre></div></div>
<p>The plot you’ve made should look like this:</p>
<center> <img src="/img/ordexample.png" alt="Img" style="width: 800px;"> </center>

<p>It is now a lot easier to interpret your data. Can you see which samples have a similar species composition?</p>

<p><strong>In this tutorial, we only focus on unconstrained ordination or indirect gradient analysis.</strong> This ordination goes in two steps. First, we will perfom an ordination on a species abundance matrix. Then we will use environmental data (samples by environmental variables) to interpret the gradients that were uncovered by the ordination. The final result will look like this:</p>

<center> <img src="/img/ordexample2.png" alt="Img" style="width: 800px;"> </center>

<h2 id="ordination-vs-classification">Ordination vs. classification</h2>

<p>Ordination and classification (or clustering) are the two main classes of multivariate methods that community ecologists employ. To some degree, these two approaches are complementary. Classification, or putting samples into (perhaps hierarchical) classes, is often useful when one wishes to assign names to, or to map, ecological communities. However, given the continuous nature of communities, ordination can be considered a more natural approach. <strong>Ordination aims at arranging samples or species continuously along gradients.</strong></p>

<p>If you want to know how to do a classification, please check out our <a href="https://ourcodingclub.github.io/2017/03/21/data-clustering.html" target="_blank" rel="noopener noreferrer">Intro to data clustering</a>.</p>

<p><a name="section2"></a></p>
<h1 id="2-different-ordination-techniques">2. Different ordination techniques</h1>
<p><strong>In this section you will learn more about how and when to use the three main (unconstrained) ordination techniques:</strong></p>
<h5 id="---principal-component-analysis-pca">- <a href="#section4"> Principal Component Analysis (PCA)</a>
</h5>
<h5 id="---principal-coordinate-analysis-pcoa">- <a href="#section5"> Principal Coordinate Analysis (PCoA)</a>
</h5>
<h5 id="---non-metric-multidimensional-scaling-nmds">- <a href="#section6"> Non-metric Multidimensional Scaling (NMDS)</a>
</h5>

<p><a name="section4"></a></p>
<h2 id="principal-component-analysis-pca">Principal Component Analysis (PCA)</h2>
<p>PCA uses a rotation of the original axes to derive new axes, which maximize the variance in the data set. In 2D, this looks as follows:</p>
<center> <img src="/img/PCAexample.png" alt="Img" style="width: 800px;"> </center>

<p>Computationally, <strong>PCA is an eigenanalysis</strong>. The most important consequences of this are:</p>

<ul>
  <li>
    <p>There is a unique solution to the eigenanalysis.</p>
  </li>
  <li>
    <p>The axes (also called principal components or PC) are orthogonal to each other (and thus independent).</p>
  </li>
  <li>
    <p>Each PC is associated with an eigenvalue. The sum of the eigenvalues will equal the sum of the variance of all variables in the data set. The eigenvalues represent the variance extracted by each PC, and are often expressed as a percentage of the sum of all eigenvalues (i.e. total variance). The relative eigenvalues thus tell how much variation that a PC is able to ‘explain’.</p>
  </li>
  <li>
    <p>Axes are ranked by their eigenvalues. Thus, the first axis has the highest eigenvalue and thus explains the most variance, the second axis has the second highest eigenvalue, etc.</p>
  </li>
  <li>
    <p>There are a potentially large number of axes (usually, the number of samples minus one, or the number of species minus one, whichever is less) so there is no need to specify the dimensionality in advance. However, the number of dimensions worth interpreting is usually very low.</p>
  </li>
  <li>
    <p>Species and samples are ordinated simultaneously, and can hence both be represented on the same ordination diagram (if this is done, it is termed a biplot)</p>
  </li>
  <li>
    <p>The variable loadings of the original variables on the PCA’s may be understood as how much each variable ‘contributed’ to building a PC. The absolute value of the loadings should be considered as the signs are arbitrary.</p>
  </li>
</ul>

<p><strong>In most applications of PCA, variables are often measured in different units. For example, PCA of environmental data may include pH, soil moisture content, soil nitrogen, temperature and so on. For such data, the data must be standardized to zero mean and unit variance. For ordination of ecological communities, however, all species are measured in the same units, and the data do not need to be standardized.</strong></p>

<p>Let´s have a look how to do a <code class="language-plaintext highlighter-rouge">PCA</code> in <code class="language-plaintext highlighter-rouge">R</code>. You can use several packages to perform a PCA: The <code class="language-plaintext highlighter-rouge">rda()</code> function in the package <code class="language-plaintext highlighter-rouge">vegan</code>, The <code class="language-plaintext highlighter-rouge">prcomp()</code> function in the package <code class="language-plaintext highlighter-rouge">stats</code> and the <code class="language-plaintext highlighter-rouge">pca()</code> function in the package <code class="language-plaintext highlighter-rouge">labdsv</code>. We will use the <code class="language-plaintext highlighter-rouge">rda()</code> function and apply it to our <code class="language-plaintext highlighter-rouge">varespec</code> dataset.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PCA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rda</span><span class="p">(</span><span class="n">varespec</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="c1"># Use scale = TRUE if your variables are on different scales (e.g. for abiotic variables).</span><span class="w">
</span><span class="c1"># Here, all species are measured on the same scale </span><span class="w">
</span><span class="c1"># So use scale = FALSE</span><span class="w">

</span><span class="c1"># Now plot a bar plot of relative eigenvalues. This is the percentage variance explained by each axis</span><span class="w">
</span><span class="n">barplot</span><span class="p">(</span><span class="n">as.vector</span><span class="p">(</span><span class="n">PCA</span><span class="o">$</span><span class="n">CA</span><span class="o">$</span><span class="n">eig</span><span class="p">)</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">PCA</span><span class="o">$</span><span class="n">CA</span><span class="o">$</span><span class="n">eig</span><span class="p">))</span><span class="w"> 
</span><span class="c1"># How much of the variance in our dataset is explained by the first principal component?</span><span class="w">

</span><span class="c1"># Calculate the percent of variance explained by first two axes</span><span class="w">
</span><span class="nf">sum</span><span class="p">((</span><span class="n">as.vector</span><span class="p">(</span><span class="n">PCA</span><span class="o">$</span><span class="n">CA</span><span class="o">$</span><span class="n">eig</span><span class="p">)</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">PCA</span><span class="o">$</span><span class="n">CA</span><span class="o">$</span><span class="n">eig</span><span class="p">))[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span><span class="w"> </span><span class="c1"># 79%, this is ok.</span><span class="w">
</span><span class="c1"># Also try to do it for the first three axes</span><span class="w">

</span><span class="c1"># Now, we`ll plot our results with the plot function</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">PCA</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">PCA</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sites"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"points"</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">PCA</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"species"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"text"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Try to display both species and sites with points. This should look like this:</p>
<center> <img src="/img/PCAresult.png" alt="Img" style="width: 800px;"> </center>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># You can extract the species and site scores on the new PC for further analyses:</span><span class="w">
</span><span class="n">sitePCA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PCA</span><span class="o">$</span><span class="n">CA</span><span class="o">$</span><span class="n">u</span><span class="w"> </span><span class="c1"># Site scores</span><span class="w">
</span><span class="n">speciesPCA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PCA</span><span class="o">$</span><span class="n">CA</span><span class="o">$</span><span class="n">v</span><span class="w"> </span><span class="c1"># Species scores</span><span class="w">

</span><span class="c1"># In a biplot of a PCA, species' scores are drawn as arrows </span><span class="w">
</span><span class="c1"># that point in the direction of increasing values for that variable</span><span class="w">
</span><span class="n">biplot</span><span class="p">(</span><span class="n">PCA</span><span class="p">,</span><span class="w"> </span><span class="n">choices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span><span class="w"> </span><span class="s2">"points"</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-5</span><span class="p">,</span><span class="m">10</span><span class="p">))</span><span class="w"> </span><span class="c1"># biplot of axis 1 vs 2</span><span class="w">
</span><span class="n">biplot</span><span class="p">(</span><span class="n">PCA</span><span class="p">,</span><span class="w"> </span><span class="n">choices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span><span class="s2">"points"</span><span class="p">))</span><span class="w"> </span><span class="c1"># biplot of axis 1 vs 3</span><span class="w">
</span></code></pre></div></div>
<center> <img src="/img/biplotresult.png" alt="Img" style="width: 800px;"> </center>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Check out the help file how to pimp your biplot further:</span><span class="w">
</span><span class="o">?</span><span class="n">biplot.rda</span><span class="w">

</span><span class="c1"># You can even go beyond that, and use the ggbiplot package.</span><span class="w">
</span><span class="c1"># You can install this package by running:</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">devtools</span><span class="p">)</span><span class="w">
</span><span class="n">install_github</span><span class="p">(</span><span class="s2">"ggbiplot"</span><span class="p">,</span><span class="w"> </span><span class="s2">"vqv"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggbiplot</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>In contrast to some of the other ordination techniques, species are represented by arrows. This implies that the abundance of the species is continuously increasing in the direction of the arrow, and decreasing in the opposite direction. Thus PCA is a linear method. PCA is extremely useful when we expect species to be linearly (or even monotonically) related to each other. Unfortunately, we rarely encounter such a situation in nature. It is much more likely that species have a unimodal species response curve:</p>

<center> <img src="/img/Unimodalresp.png" alt="Img" style="width: 800px;"> </center>

<p>Unfortunately, <strong>this linear assumption causes PCA to suffer from a serious problem, the horseshoe or arch effect</strong>, which makes it unsuitable for most ecological datasets. The PCA solution is often distorted into a horseshoe/arch shape (with the toe either up or down) if beta diversity is moderate to high. The horseshoe can appear even if there is an important secondary gradient. Can you detect a horseshoe shape in the biplot?</p>

<p><a name="section5"></a></p>
<h3 id="principal-coordinate-analysis-pcoa">Principal Coordinate Analysis (PCoA)</h3>
<p><strong>Principal coordinates analysis (PCoA, also known as metric multidimensional scaling) attempts to represent the distances between samples in a low-dimensional, Euclidean space. In particular, it maximizes the linear correlation between the distances in the distance matrix, and the distances in a space of low dimension (typically, 2 or 3 axes are selected). The PCoA algorithm is analogous to rotating the multidimensional object such that the distances (lines) in the shadow are maximally correlated with the distances (connections) in the object:</strong></p>

<center> <img src="/img/PCOAexample.gif" alt="Img" style="width: 800px;"> </center>

<p><strong>The first step of a PCoA is the construction of a (dis)similarity matrix</strong>. While PCA is based on Euclidean distances, PCoA can handle (dis)similarity matrices calculated from quantitative, semi-quantitative, qualitative, and mixed variables. As always, the choice of (dis)similarity measure is critical and must be suitable to the data in question. If you want to know more about distance measures, please check out our <a href="https://ourcodingclub.github.io/2017/03/21/data-clustering.html#Distance" target="_blank" rel="noopener noreferrer">Intro to data clustering</a>. For abundance data, Bray-Curtis distance is often recommended. You can use Jaccard index for presence/absence data. When the distance metric is Euclidean, PCoA is equivalent to Principal Components Analysis. <strong>Although PCoA is based on a (dis)similarity matrix, the solution can be found by eigenanalysis</strong>. The interpretation of the results is the same as with PCA.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First step is to calculate a distance matrix. </span><span class="w">
</span><span class="c1"># Here we use Bray-Curtis distance metric</span><span class="w">
</span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vegdist</span><span class="p">(</span><span class="n">varespec</span><span class="p">,</span><span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bray"</span><span class="p">)</span><span class="w">

</span><span class="c1"># PCoA is not included in vegan. </span><span class="w">
</span><span class="c1"># We will use the ape package instead</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ape</span><span class="p">)</span><span class="w">
</span><span class="n">PCOA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pcoa</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot the eigenvalues and interpret</span><span class="w">
</span><span class="n">barplot</span><span class="p">(</span><span class="n">PCOA</span><span class="o">$</span><span class="n">values</span><span class="o">$</span><span class="n">Relative_eig</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">])</span><span class="w">
</span><span class="c1"># Can you also calculate the cumulative explained variance of the first 3 axes?</span><span class="w">

</span><span class="c1"># Some distance measures may result in negative eigenvalues. In that case, add a correction:</span><span class="w">
</span><span class="n">PCOA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pcoa</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cailliez"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot your results</span><span class="w">
</span><span class="n">biplot.pcoa</span><span class="p">(</span><span class="n">PCOA</span><span class="p">)</span><span class="w">

</span><span class="c1"># You see what`s missing? </span><span class="w">
</span><span class="c1"># Indeed, there are no species plotted on this biplot. </span><span class="w">
</span><span class="c1"># That's because we used a dissimilarity matrix (sites x sites) </span><span class="w">
</span><span class="c1"># as input for the PCOA function. </span><span class="w">
</span><span class="c1"># Hence, no species scores could be calculated. </span><span class="w">
</span><span class="c1">#However, we could work around this problem like this:</span><span class="w">
</span><span class="n">biplot.pcoa</span><span class="p">(</span><span class="n">PCOA</span><span class="p">,</span><span class="w"> </span><span class="n">varespec</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<center> <img src="/img/PCOA.png" alt="Img" style="width: 800px;"> </center>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Extract the plot scores from first two PCoA axes (if you need them):</span><span class="w">
</span><span class="n">PCOAaxes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PCOA</span><span class="o">$</span><span class="n">vectors</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">)]</span><span class="w">

</span><span class="c1"># Compare this result with the PCA plot</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w"> 
</span><span class="n">biplot.pcoa</span><span class="p">(</span><span class="n">PCOA</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">PCA</span><span class="p">)</span><span class="w">

</span><span class="c1"># reset plot window</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> 
</span></code></pre></div></div>

<p><strong>PCoA suffers from a number of flaws, in particular the arch effect (see PCA for more information). These flaws stem, in part, from the fact that PCoA maximizes a linear correlation. Non-metric Multidimensional Scaling (NMDS) rectifies this by maximizing the rank order correlation.</strong></p>

<p><a name="section6"></a></p>
<h2 id="non-metric-multidimensional-scaling-nmds">Non-metric Multidimensional Scaling (NMDS)</h2>
<p><strong>NMDS attempts to represent the pairwise dissimilarity between objects in a low-dimensional space. Any dissimilarity coefficient or distance measure may be used to build the distance matrix used as input. __NMDS is a rank-based approach</strong>.__ This means that the original distance data is substituted with ranks. Thus, rather than object A being 2.1 units distant from object B and 4.4 units distant from object C, object C is the “first” most distant from object A while object C is the “second” most distant. While information about the magnitude of distances is lost, rank-based methods are generally more robust to data which do not have an identifiable distribution.</p>

<p>NMDS is an iterative algorithm. NMDS routines often begin by random placement of data objects in ordination space. The algorithm then begins to refine this placement by an iterative process, attempting to find an ordination in which ordinated object distances closely match the order of object dissimilarities in the original distance matrix. The stress value reflects how well the ordination summarizes the observed distances among the samples.</p>

<p><strong>NMDS is not an eigenanalysis</strong>. This has three important consequences:</p>
<ul>
  <li>There is no unique ordination result</li>
  <li>The axes of the ordination are not ordered according to the variance they explain</li>
  <li>The number of dimensions of the low-dimensional space must be specified before running the analysis</li>
</ul>

<p>There is no unique solution. The end solution depends on the random placement of the objects in the first step. Running the NMDS algorithm multiple times to ensure that the ordination is stable is necessary, as any one run may get “trapped” in local optima which are not representative of true distances. Note: this automatically done with the <code class="language-plaintext highlighter-rouge">metaMDS()</code> in <code class="language-plaintext highlighter-rouge">vegan</code>.</p>

<p>Axes are not ordered in NMDS. <code class="language-plaintext highlighter-rouge">metaMDS()</code> in <code class="language-plaintext highlighter-rouge">vegan</code> automatically rotates the final result of the NMDS using PCA to make axis 1 correspond to the greatest variance among the NMDS sample points. This doesn’t change the interpretation, cannot be modified, and is a good idea, but you should be aware of it.</p>

<p>A plot of stress (a measure of goodness-of-fit) vs. dimensionality can be used to assess the proper choice of dimensions. The stress values themselves can be used as an indicator. Stress values <code class="language-plaintext highlighter-rouge">&gt;0.2</code> are generally poor and potentially uninterpretable, whereas values <code class="language-plaintext highlighter-rouge">&lt;0.1</code> are good and <code class="language-plaintext highlighter-rouge">&lt;0.05</code> are excellent, leaving little danger of misinterpretation. Stress values between <code class="language-plaintext highlighter-rouge">0.1</code> and <code class="language-plaintext highlighter-rouge">0.2</code> are useable but some of the distances will be misleading. Finding the inflexion point can instruct the selection of a minimum number of dimensions.</p>

<center> <img src="/img/NMDSstress.PNG" alt="Img" style="width: 800px;"> </center>

<p><strong>Methodology of NMDS:</strong></p>
<ul>
  <li>
<strong>Step 1:</strong> Perform NMDS with 1 to 10 dimensions</li>
  <li>
<strong>Step 2:</strong> Check the stress vs dimension plot</li>
  <li>
<strong>Step 3:</strong> Choose optimal number of dimensions</li>
  <li>
<strong>Step 4:</strong> Perform final NMDS with that number of dimensions</li>
  <li>
<strong>Step 5:</strong> Check for convergent solution and final stress</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># First step is to calculate a distance matrix. See PCOA for more information about the distance measures</span><span class="w">
</span><span class="c1"># Here we use bray-curtis distance, which is recommended for abundance data</span><span class="w">
</span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vegdist</span><span class="p">(</span><span class="n">varespec</span><span class="p">,</span><span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bray"</span><span class="p">)</span><span class="w">

</span><span class="c1"># In this part, we define a function NMDS.scree() that automatically </span><span class="w">
</span><span class="c1"># performs a NMDS for 1-10 dimensions and plots the nr of dimensions vs the stress</span><span class="w">
</span><span class="n">NMDS.scree</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">#where x is the name of the data frame variable</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">replicate</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">metaMDS</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">autotransform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">$</span><span class="n">stress</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.30</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"# of Dimensions"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Stress"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NMDS stress plot"</span><span class="p">)</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">points</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="n">replicate</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">metaMDS</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">autotransform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">$</span><span class="n">stress</span><span class="p">))</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Use the function that we just defined to choose the optimal nr of dimensions</span><span class="w">
</span><span class="n">NMDS.scree</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<center> <img src="/img/NMDSscree.png" alt="Img" style="width: 800px;"> </center>

<p>On this graph, we don´t see a data point for 1 dimension. Do you know what happened? Tip: Run a NMDS (with the function <code class="language-plaintext highlighter-rouge">metaNMDS()</code> with one dimension to find out what’s wrong. Then adapt the function above to fix this problem.</p>

<p>We further see on this graph that the stress decreases with the number of dimensions. This is a normal behavior of a stress plot. This graph doesn´t have a very good inflexion point. So here, you would select a nr of dimensions for which the stress meets the criteria. This would be <code class="language-plaintext highlighter-rouge">3-4 D</code>. To make this tutorial easier, let’s select two dimensions. This is also an ok solution. Now, we will perform the final analysis with 2 dimensions</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Because the final result depends on the initial </span><span class="w">
</span><span class="c1"># random placement of the points </span><span class="w">
</span><span class="c1"># we`ll set a seed to make the results reproducible</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w">

</span><span class="c1"># Here, we perform the final analysis and check the result</span><span class="w">
</span><span class="n">NMDS1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">metaMDS</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">trymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="c1"># Do you know what the trymax = 100 and trace = F means?</span><span class="w">
</span><span class="c1"># Let's check the results</span><span class="w">
</span><span class="n">NMDS1</span><span class="w">

</span><span class="c1"># If you don`t provide a dissimilarity matrix, metaMDS automatically applies Bray-Curtis. So in our case, the results would have to be the same</span><span class="w">
</span><span class="n">NMDS2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">metaMDS</span><span class="p">(</span><span class="n">varespec</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">trymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">NMDS2</span><span class="w">
</span></code></pre></div></div>

<p>The results are not the same! Can you see the reason why? <code class="language-plaintext highlighter-rouge">metaMDS()</code> has indeed calculated the Bray-Curtis distances, but first applied a square root transformation on the community matrix. Check the help file for <code class="language-plaintext highlighter-rouge">metaNMDS()</code> and try to adapt the function for NMDS2, so that the automatic transformation is turned off.</p>

<p>Let’s check the results of NMDS1 with a stressplot</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stressplot</span><span class="p">(</span><span class="n">NMDS1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<center> <img src="/img/NMDSstressplot.png" alt="Img" style="width: 800px;"> </center>

<p>There is a good non-metric fit between observed dissimilarities (in our distance matrix) and the distances in ordination space. Also the stress of our final result was ok (do you know how much the stress is?). So we can go further and plot the results:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">NMDS1</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"t"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>There are no species scores (same problem as we encountered with PCoA). We can work around this problem, by giving metaMDS the original community matrix as input and specifying the distance measure.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">NMDS3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">metaMDS</span><span class="p">(</span><span class="n">varespec</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">trymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">autotransform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">distance</span><span class="o">=</span><span class="s2">"bray"</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sites"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sites"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.25</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="s2">"species"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Alternatively, you can use the functions ordiplot and orditorp</span><span class="w">
</span><span class="n">ordiplot</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">)</span><span class="w">
</span><span class="n">orditorp</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"species"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">)</span><span class="w">
</span><span class="n">orditorp</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sites"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.1</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">)</span><span class="w">


</span></code></pre></div></div>
<center> <img src="/img/NMDSbiplot.png" alt="Img" style="width: 800px;"> </center>

<p><a name="section3"></a></p>
<h1 id="3-interpretation-of-the-results">3. Interpretation of the results</h1>

<p>We now have a nice ordination plot and we know which plots have a similar species composition. We also know that the first ordination axis corresponds to the largest gradient in our dataset (the gradient that explains the most variance in our data), the second axis to the second biggest gradient and so on. <strong>The next question is: Which environmental variable is driving the observed differences in species composition?</strong> We can do that by correlating environmental variables with our ordination axes. Therefore, we will use a second dataset with environmental variables (sample by environmental variables). We continue using the results of the NMDS.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load the second dataset</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="n">varechem</span><span class="p">)</span><span class="w">

</span><span class="c1"># The function envfit will add the environmental variables as vectors to the ordination plot</span><span class="w">
</span><span class="n">ef</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">envfit</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">varechem</span><span class="p">,</span><span class="w"> </span><span class="n">permu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">999</span><span class="p">)</span><span class="w">
</span><span class="n">ef</span><span class="w">

</span><span class="c1"># The two last columns are of interest: the squared correlation coefficient and the associated p-value</span><span class="w">
</span><span class="c1"># Plot the vectors of the significant correlations and interpret the plot</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"t"</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sites"</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span><span class="w"> </span><span class="n">p.max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<center> <img src="/img/NMDSenvfit.png" alt="Img" style="width: 800px;"> </center>

<p>It´s easy as that. Next, let’s say that the we have two groups of samples. This could be the result of a classification or just two predefined groups (e.g. old versus young forests or two treatments). Now, we want to see the two groups on the ordination plot. Here is how you do it:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Define a group variable (first 12 samples belong to group 1, last 12 samples to group 2)</span><span class="w">
</span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s2">"Group1"</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"Group2"</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w">

</span><span class="c1"># Create a vector of color values with same length as the vector of group values</span><span class="w">
</span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">))</span><span class="w">

</span><span class="c1"># Plot convex hulls with colors based on the group identity</span><span class="w">
</span><span class="n">ordiplot</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">group</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">ordihull</span><span class="p">(</span><span class="n">NMDS3</span><span class="o">$</span><span class="n">point</span><span class="p">[</span><span class="n">grep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="p">),],</span><span class="w"> </span><span class="n">draw</span><span class="o">=</span><span class="s2">"polygon"</span><span class="p">,</span><span class="w">
   </span><span class="n">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group</span><span class="p">[</span><span class="n">group</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">],</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">[</span><span class="n">grep</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">group</span><span class="p">)],</span><span class="n">label</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> 

</span><span class="n">orditorp</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"species"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">)</span><span class="w">
</span><span class="n">orditorp</span><span class="p">(</span><span class="n">NMDS3</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sites"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="w">
  </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">)),</span><span class="w"> </span><span class="n">air</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.25</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<center> <img src="/img/NMDScluster.png" alt="Img" style="width: 800px;"> </center>

<p><strong>Congratulations! You´ve made it to the end of the tutorial! Now you can put your new knowledge into practice with a couple of challenges.</strong></p>

<p><a name="section4"></a></p>
<h1 id="4-your-turn">4. Your turn</h1>

<h2 id="challenge-number-1">Challenge number 1</h2>
<p>Perform an ordination analysis on the dune dataset (use <code class="language-plaintext highlighter-rouge">data(dune)</code> to import) provided by the vegan package. Interpret your results using the environmental variables from <code class="language-plaintext highlighter-rouge">dune.env</code>.</p>

<h2 id="challenge-number-2">Challenge number 2</h2>
<p>If you already know how to do a classification analysis, you can also perform a classification on the dune data. Then combine the ordination and classification results as we did above. Please have a look at out tutorial <a href="https://ourcodingclub.github.io/2017/03/21/data-clustering.html" target="_blank" rel="noopener noreferrer">Intro to data clustering</a>, for more information on classification.</p>

<hr>

<p><strong>This is the end of the tutorial. In this tutorial we learned:</strong></p>

<h5 id="--about-the-different-unconstrained-ordination-techniques">- about the different (unconstrained) ordination techniques</h5>
<h5 id="--how-to-perform-an-ordination-analysis-in-vegan-and-ape">- how to perform an ordination analysis in vegan and ape</h5>
<h5 id="--how-to-interpret-the-results-of-the-ordination">- how to interpret the results of the ordination</h5>

<p>For more on <code class="language-plaintext highlighter-rouge">vegan</code> and how to use it for multivariate analysis of ecological communities, read this <a href="http://cc.oulu.fi/~jarioksa/opetus/metodi/vegantutor.pdf" target="_blank" rel="noopener noreferrer">vegan tutorial</a>. Another good website to learn more about statistical analysis of ecological data is <a href="https://sites.google.com/site/mb3gustame/home" target="_blank" rel="noopener noreferrer">GUSTA ME</a>. To construct this tutorial, we borrowed from <a href="https://sites.google.com/site/mb3gustame/home" target="_blank" rel="noopener noreferrer">GUSTA ME</a> and and <a href="http://ordination.okstate.edu/" target="_blank" rel="noopener noreferrer">Ordination methods for ecologists</a>.</p>

<hr>

<hr>

<p><strong>Check out <a href="https://ourcodingclub.github.io/workshop/" target="_blank" rel="noopener noreferrer">this page</a> to learn how you can get involved! We are very happy to have people use our tutorials and adapt them to their needs. We are also very keen to expand the content on the website, so feel free to get in touch if you’d like to write a tutorial!</strong></p>

<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer">Creative Commons Attribution-ShareAlike 4.0 International License</a>. <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" alt="Img" style="width: 100px;"></a></p>

<h3><a href="https://www.surveymonkey.co.uk/r/VYLPZ29" target="_blank" rel="noopener noreferrer">  We would love to hear your feedback, please fill out our survey!</a></h3>

<p><br></p>
<h3>  You can contact us with any questions on <a href="mailto:ourcodingclub@gmail.com?Subject=Tutorial%20question" target="_top">ourcodingclub@gmail.com</a>
</h3>
<p><br></p>
<h3>  Related tutorials:</h3>

<ul>
  
  
</ul>

<p><br></p>
<h3>  Subscribe to our mailing list:</h3>
<div class="container">
	<div class="block">
        <!-- subscribe form start -->
		<div class="form-group">
			<form action="https://getsimpleform.com/messages?form_api_token=de1ba2f2f947822946fb6e835437ec78" method="post">
			<div class="form-group">
				<input type="text" class="form-control" name="Email" placeholder="Email" required="">
			</div>
			<div>
                        	<button class="btn btn-default" type="submit">Subscribe</button>
                    	</div>
                	</form>
		</div>
	</div>
</div>

<ul class="social-icons">
	<li>
		<h3>
			<a href="https://twitter.com/our_codingclub" target="_blank" rel="noopener noreferrer"> Follow our coding adventures on Twitter! <i class="fa fa-twitter"></i></a>
		</h3>
	</li>
</ul>

    	<footer class="footer">
	<hr>
	<div class="footer-container">
    	<ul class="footer-link-list">
        	<li><a href="/tutorials">Tutorials</a></li>
        	<li><a href="/team">About Us</a></li>
        	<li><a href="/contact">Contact us</a></li>
	    	<li><a href="https://twitter.com/our_codingclub" target="_blank" rel="noopener noreferrer">Follow us on Twitter</a></li>
    	</ul>
    	<div class="footer-text">
			<p>We are happy for people to use and further develop our tutorials - please give credit to Coding Club by linking to <a href="https://ourcodingclub.github.io/" target="_blank" rel="noopener noreferrer">our website</a>. We are also happy to discuss possible collaborations, so get in touch at <b>ourcodingclub@gmail.com</b></p>
    		<p>See our <a href="/terms">Terms of Use</a> and our <a href="/privacy">Data Privacy policy</a>.</p>
			<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer">Creative Commons Attribution-ShareAlike 4.0 International License</a></p>
			<a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer"><img class="license" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" alt="CC-by-sa-4.0"></a>
    	</div>
    </div>
</footer>

<!-- JS -->
<script src="/scripts/owl.carousel.js"></script>
<script src="/scripts/owl.carousel-init.js"></script>
<script src="/scripts/reveal.js"></script>


	
	</body>
</html>
